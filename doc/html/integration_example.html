<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>##Antidot PHP API: Integration example</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>Integration example </h1>  </div>
</div>
<div class="contents">
<h2><a class="anchor" id="ie_prerequisite"></a>
Prerequisites</h2>
<p>In order to test this example, following components are required.</p>
<h3><a class="anchor" id="ie_http_server"></a>
HTTP server</h3>
<p>Operationnal HTTP server with PHP support is mandatory. Supported PHP version should be at least 5.1.</p>
<h3><a class="anchor" id="ie_twig"></a>
Twig template engine</h3>
<p>Twig is a flexible, fast, and secure template engine for PHP. It will be used here to simplify integration example.</p>
<p>It can be downloaded from <a href="http://pear.twig-project.org/get/Twig-1.14.1.tgz">http://pear.twig-project.org/get/Twig-1.14.1.tgz</a></p>
<p>On GNU/Linux, necessary files can be uncompressed in <code>/var/www/php-example/</code>.</p>
<h3><a class="anchor" id="ie_bootstrap"></a>
Bootstrap (optional)</h3>
<p>Bootstrap is a front-end framework. It is used to generate pretty HTML pages with little effort.</p>
<p>Necessary files can be downloaded and put to appropriate place. Then <code>meta_template.html</code> should be updated accordingly.</p>
<p>Or, you can keep files unchanged and still point to external location.</p>
<h3><a class="anchor" id="ie_php_api"></a>
Antidot PHP API</h3>
<p>Yes, you need it! You can grab it from <a href="https://github.com/antidot/API.">https://github.com/antidot/API.</a></p>
<p>On GNU/Linux you can probably put everything in <code>/var/www/php-example/</code>.</p>
<h3><a class="anchor" id="ie_antidot_service"></a>
Antidot search service</h3>
<p>For purpose of this example you can refer free available service with id <code>70000</code> at <a href="http://eval.partners.antidot.net.">http://eval.partners.antidot.net.</a></p>
<h2><a class="anchor" id="ie_example"></a>
Set up example step by step</h2>
<p>Most of the steps to set up this example are detailed in <a class="el" href="afs_search_coder.html">AFS search query coder/decoder API</a>, <a class="el" href="afs_search_query.html">AFS search query API</a> and <a class="el" href="afs_search_reply.html">AFS search reply API</a>.</p>
<p>Here focus is given on missing steps in order to make the example fully functional.</p>
<h3><a class="anchor" id="ie_example_init"></a>
Initialization</h3>
<p>It should be the first step. Antidot PHP API should be loaded from PHP example script. It is not necessary to load each PHP script as one main script does it for you:  full_example.php Include lib</p>
<p>Then Twig should also be loaded and initialized. Depending on your installation choices, following example may be modified to reflect your installation paths:  full_example.php Twig init</p>
<h3><a class="anchor" id="ie_example_final"></a>
Generate HTML page</h3>
<p>This is the last step.<br/>
 Main Twig template is loaded with appropriate parameters and then rendered:  full_example.php Twig template This code brevity is obtained thanks to special array formatting of reply helpers (see <em>AFS_ARRAY_FORMAT</em>).</p>
<h3><a class="anchor" id="ie_example_full"></a>
Full example</h3>
<p>The full example is also available here: <a class="el" href="full_example_8php-example.html">full_example::php</a></p>
<h2><a class="anchor" id="ie_templates"></a>
PHP template examples</h2>
<p>They are available here: <a href="https://github.com/antidot/API/tree/master/PHP/doc/data/templates.">https://github.com/antidot/API/tree/master/PHP/doc/data/templates.</a> But for convenience, content of each template file is given below.</p>
<p>On GNU/Linux, these templates can be put in <code>/var/www/php-example/templates</code>.</p>
<p>Templates will not be detaillled. If necessary, more documentation is available at Twig website.</p>
<h3><a class="anchor" id="ie_template_main"></a>
Main template</h3>
<p>This template is called to render the HTML page.</p>
<p><em>meta_template.html</em> </p>
<div class="fragment"><pre class="fragment">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Antidot PHP API - Example&lt;/title&gt;
    &lt;meta name=<span class="stringliteral">&quot;viewport&quot;</span> content=<span class="stringliteral">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;
    &lt;meta charset=<span class="stringliteral">&quot;UTF-8&quot;</span>&gt;
    &lt;link rel=<span class="stringliteral">&quot;stylesheet&quot;</span> href=<span class="stringliteral">&quot;//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css&quot;</span>&gt;
    &lt;link rel=<span class="stringliteral">&quot;stylesheet&quot;</span> href=<span class="stringliteral">&quot;//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-theme.min.css&quot;</span>&gt;

    &lt;!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries --&gt;
    &lt;!--[<span class="keywordflow">if</span> lt IE 9]&gt;
      &lt;script src=<span class="stringliteral">&quot;../../assets/js/html5shiv.js&quot;</span>&gt;&lt;/script&gt;
      &lt;script src=<span class="stringliteral">&quot;../../assets/js/respond.min.js&quot;</span>&gt;&lt;/script&gt;
    &lt;![endif]--&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;page-header&quot;</span>&gt;
      &lt;h1&gt;Example &lt;small&gt;based on the Antidot PHP API&lt;/small&gt;&lt;/h1&gt;
    &lt;/div&gt;

    &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;row&quot;</span>&gt;
      &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;col-md-5&quot;</span>&gt;&lt;/div&gt;
      &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;input-group col-md-2&quot;</span>&gt;
        &lt;form method=<span class="stringliteral">&quot;get&quot;</span> action=<span class="stringliteral">&quot;&quot;</span> role=<span class="stringliteral">&quot;form&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;input-group&quot;</span>&gt;
          &lt;span <span class="keyword">class</span>=<span class="stringliteral">&quot;input-group-addon&quot;</span>&gt;Search&lt;/span&gt;
          &lt;input type=<span class="stringliteral">&quot;search&quot;</span> name=<span class="stringliteral">&quot;query&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;form-control&quot;</span> placeholder=<span class="stringliteral">&quot;Keywords&quot;</span> /&gt;
          &lt;span <span class="keyword">class</span>=<span class="stringliteral">&quot;input-group-btn&quot;</span>&gt;
            &lt;button <span class="keyword">class</span>=<span class="stringliteral">&quot;btn btn-primary&quot;</span> type=<span class="stringliteral">&quot;submit&quot;</span>&gt;&lt;span <span class="keyword">class</span>=<span class="stringliteral">&quot;glyphicon glyphicon-search&quot;</span>&gt;&lt;/span&gt;&lt;/button&gt;
          &lt;/span&gt;
        &lt;/form&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;row&quot;</span>&gt;
      {% include <span class="stringliteral">&#39;facet_template.html&#39;</span> %}
      {% include <span class="stringliteral">&#39;result_template.html&#39;</span> %}
    &lt;/div&gt;

    &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;row&quot;</span>&gt;
      {% include <span class="stringliteral">&#39;pager_template.html&#39;</span> %}
    &lt;/div&gt;

    &lt;!-- jQuery (necessary <span class="keywordflow">for</span> Bootstrap<span class="stringliteral">&#39;s JavaScript plugins) --&gt;</span>
<span class="stringliteral">    &lt;script src=&quot;//code.jquery.com/jquery.js&quot;&gt;&lt;/script&gt;</span>
<span class="stringliteral">    &lt;!-- Include all compiled plugins (below), or include individual files as needed --&gt;</span>
<span class="stringliteral">    &lt;script src=&quot;js/bootstrap.min.js&quot;&gt;&lt;/script&gt;</span>
<span class="stringliteral">  &lt;/body&gt;</span>
<span class="stringliteral">&lt;/html&gt;</span>
</pre></div><p> Except that it refers three templates, there is nothing noticable here. Included templates are described below.</p>
<h3><a class="anchor" id="ie_template_facet"></a>
Facet template</h3>
<p><em>facet_template.html</em> </p>
<div class="fragment"><pre class="fragment">{% <span class="keywordflow">if</span> facets %}
&lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;col-md-3&quot;</span>&gt;
  &lt;h2&gt;Filters&lt;/h2&gt;
  {% <span class="keywordflow">for</span> facet in facets %}
    &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;panel panel-default&quot;</span>&gt;
      &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;panel-heading&quot;</span>&gt;{{ facet.label }}&lt;/div&gt;
      &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;panel-body&quot;</span>&gt;
        {% <span class="keywordflow">if</span> facet.values is not empty %}
          &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;list-group&quot;</span>&gt;
          {{ include(<span class="stringliteral">&#39;facet_values_template.html&#39;</span>, {values: facet.values, depth: 0}, with_context=<span class="keyword">false</span>) }}
          &lt;/div&gt;
        {% endif %}
      &lt;/div&gt;
    &lt;/div&gt;
  {% endfor %}
&lt;/div&gt;
{%  endif %}
</pre></div><p> It is quite easy to find the loop which allows to set up all facets. Then, in turn, this template refers specific template for facet values.</p>
<p><em>facet_values_template.html</em> </p>
<div class="fragment"><pre class="fragment">&lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;list-group&quot;</span>&gt;
  {% <span class="keywordflow">for</span> value in values %}
    &lt;a <span class="keyword">class</span>=<span class="stringliteral">&quot;list-group-item {{ value.active ? &#39;active&#39; : &#39;&#39; }}&quot;</span> href=<span class="stringliteral">&quot;{{ value.link }}&quot;</span>&gt;{{ value.label }}&lt;span <span class="keyword">class</span>=<span class="stringliteral">&quot;badge&quot;</span>&gt;{{ value.count }}&lt;/span&gt;&lt;/a&gt;
  {% endfor %}
&lt;/div&gt;
</pre></div><p> Here again, the loop allows to set up all values for each facet.</p>
<h3><a class="anchor" id="ie_template_result"></a>
Result template</h3>
<p>This template allows to render URI, title and abstract of each result. As sicussed previously some additional work is necessary is you want to get access to client data.</p>
<p><em>result_template.html</em> </p>
<div class="fragment"><pre class="fragment">&lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;col-md-9&quot;</span>&gt;
  &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;row&quot;</span>&gt;
    &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;col-md-1&quot;</span>&gt;&lt;/div&gt;
    &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;col-md-4&quot;</span>&gt;
      &lt;h2&gt;Results &lt;span <span class="keyword">class</span>=<span class="stringliteral">&quot;label label-success&quot;</span>&gt;{{ meta.total_replies }}&lt;/span&gt;&lt;/h2&gt;
      &lt;h4&gt;&lt;span <span class="keyword">class</span>=<span class="stringliteral">&quot;label label-info&quot;</span>&gt;Duration {{ meta.duration }} ms&lt;/span&gt;&lt;/h4&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;ul <span class="keyword">class</span>=<span class="stringliteral">&quot;list-unstyled&quot;</span>&gt;
    {% <span class="keywordflow">for</span> reply in replies %}
      &lt;li&gt;
        &lt;h3&gt;{{ reply.title|raw }}&lt;/h3&gt;
        &lt;p&gt;&lt;a href=<span class="stringliteral">&quot;{{ reply.uri|raw }}&quot;</span>&gt;{{ reply.uri }}&lt;/a&gt;&lt;/p&gt;
        &lt;p&gt;{{ reply.abstract|raw }}&lt;/p&gt;
      &lt;/li&gt;
    {% endfor %}
  &lt;/ul&gt;
&lt;/div&gt;

</pre></div><h3><a class="anchor" id="ie_template_pager"></a>
Pager template</h3>
<p>This template generates simple pager at the bottom of the page. There is really no difficulty here.</p>
<p><em>pager_template.html</em> </p>
<div class="fragment"><pre class="fragment">&lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;row&quot;</span>&gt;
  &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;col-md-5&quot;</span>&gt;&lt;/div&gt;
  &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;input-group col-md-3&quot;</span>&gt;
    &lt;ul <span class="keyword">class</span>=<span class="stringliteral">&quot;pagination&quot;</span>&gt;
      {% <span class="keywordflow">for</span> key, value in pager.pages %}
      &lt;li <span class="keyword">class</span>=<span class="stringliteral">&quot;{{ key == pager.current ? &#39;active&#39; : &#39;&#39; }}&quot;</span>&gt;&lt;a href=<span class="stringliteral">&quot;{{ value }}&quot;</span>&gt;{{ key }}&lt;/a&gt;&lt;/li&gt;
      {% endfor %}
    &lt;/ul&gt;
  &lt;/div&gt;
&lt;/div&gt;
</pre></div><h2><a class="anchor" id="ie_conclusion"></a>
Example conclusion</h2>
<p>Provided example is composed of about 28 lines of PHP code. About third of these lines are related to facet configuration. So in few PHP code lines and some PHP templates, you can get a fully functional Web interface for your Antidot search service.</p>
<h2><a class="anchor" id="ie_further"></a>
Go further</h2>
<p>Modify this example and templates then test on your own service! </p>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Fri Dec 13 2013 09:03:11 for ##Antidot PHP API by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
