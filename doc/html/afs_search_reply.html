<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Antidot PHP API: AFS search reply API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-antidot-long-200x41.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Antidot PHP API
   &#160;<span id="projectnumber">version 0.9.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">AFS search reply API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#asr_introduction">Introduction</a></li>
<li class="level1"><a href="#asr_response">Reponse helper</a></li>
<li class="level1"><a href="#asr_helper_generalities">Helper generalities</a><ul><li class="level2"><a href="#asr_helper_getters">Getters</a></li>
<li class="level2"><a href="#asr_helper_format">Helper formats</a></li>
</ul>
</li>
<li class="level1"><a href="#asr_specific_helpers">Specific helpers</a><ul><li class="level2"><a href="#asr_clientdata_helpers">Client data helpers</a></li>
</ul>
</li>
<li class="level1"><a href="#asr_end">Next step</a><ul><li class="level2"><a href="#asr_end_full_template">Full detailled example with template</a></li>
<li class="level2"><a href="#asr_end_lightweight_template">Lightweight example with template</a></li>
<li class="level2"><a href="#asr_end_full">Full detailled example without template</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="asr_introduction"></a>
Introduction</h1>
<p>This API greatly simplifies treatment of Antidot search engine replies. Main objective here is to add nearly no PHP code and make usage of PHP templates.</p>
<p>Snippets of code are usable as is and can be joined to build a fully functional example step by step. If you prefer you can get access to full code example <a class="el" href="full_example_8php-example.html">full_example.php</a>.</p>
<p>If you have not read it yet you can start by reading <a class="el" href="afs_search_query.html">AFS search query API</a>.</p>
<h1><a class="anchor" id="asr_response"></a>
Reponse helper</h1>
<p>This is the main helper (see <em><a class="el" href="classAfsSearchQueryManager.html" title="Manage search query. ">AfsSearchQueryManager</a></em> for more details). It should be initilized with result of <em><a class="el" href="classAfsSearchQueryManager.html#a0f0f607c931a468d4bdca47745508163" title="Send query to AFS search engine. ">AfsSearchQueryManager::send</a></em> method, the facet manager, the current query and the query coder (see <a class="el" href="afs_search_coder.html">AFS search query coder/decoder API</a> and <a class="el" href="afs_search_query.html">AFS search query API</a> for details on these parameters).</p>
<p>Here an example to initialize AFS response helper: </p>
<div class="fragment"><div class="line"><a class="code" href="full__example_8php.html#ab03a8518b780b4b3b7f0d88cd1bb1186">$helper</a> = <span class="keyword">new</span> <a class="code" href="classAfsResponseHelper.html">AfsResponseHelper</a>(<a class="code" href="full__lightweight__example_8php.html#a46ad7c5fff64ab9b49b9cfcaff650baa">$reply</a>, $query, <a class="code" href="full__example_8php.html#a49c7011be9c979d9174c52a8b83e5d8e">$config</a>);</div>
</div><!-- fragment --><p> On initialization, error checking is performed. When no error occured, <em><a class="el" href="classAfsResponseHelper.html#aa47b950f8dc54f7b06c97d9d12a3f767" title="Retrieves all replysets. ">AfsResponseHelper::get_replysets</a></em> returns a list of <em><a class="el" href="classAfsReplysetHelper.html" title="Helper for replies from one feed. ">AfsReplysetHelper</a></em>. By the way, following helpers are also initialized:</p>
<ul>
<li><em><a class="el" href="classAfsMetaHelper.html" title="AFS reply meta data. ">AfsMetaHelper</a></em>,</li>
<li><em><a class="el" href="classAfsFacetHelper.html" title="Helper to manage facets. ">AfsFacetHelper</a>:</em> one helper is instantiated per facet,</li>
<li><em><a class="el" href="classAfsReplyHelper.html" title="Helper to manager title, abstract and uri of one reply. ">AfsReplyHelper</a>:</em> one helper is instantiated per reply,</li>
<li><em><a class="el" href="classAfsPagerHelper.html" title="Helper for pager. ">AfsPagerHelper</a></em>.</li>
</ul>
<p>Spellcheck replies can be retrieved by calling <em><a class="el" href="classAfsResponseHelper.html#aa9ad67eb28cdd424181433a37f88cac8" title="Retrieves spellchecks from the response. ">AfsResponseHelper::get_spellchecks</a></em>, so that new query can be suggested to customer.</p>
<p>Details on each helper are available in their own documentation pages, so from now on only common features will be detailled.</p>
<h1><a class="anchor" id="asr_helper_generalities"></a>
Helper generalities</h1>
<p>Here are common main features of the helpers.</p>
<h2><a class="anchor" id="asr_helper_getters"></a>
Getters</h2>
<p>One main feature of helpers is that each getter <code>get_XXX()</code> can also be called like a property of the class.</p>
<p>For example, the two following statements are equivalent: </p>
<div class="fragment"><div class="line"><a class="code" href="full__example_8php.html#ab03a8518b780b4b3b7f0d88cd1bb1186">$helper</a>-&gt;get_error_msg();</div>
<div class="line"><a class="code" href="full__example_8php.html#ab03a8518b780b4b3b7f0d88cd1bb1186">$helper</a>-&gt;error_msg;</div>
</div><!-- fragment --><p>This convenient feature can only be used for getters that do not require parameter.</p>
<h2><a class="anchor" id="asr_helper_format"></a>
Helper formats</h2>
<p>Other main feature of helpers is that they can generate <em>formatted output</em>. In fact, starting from the main helper, you can get access to specialized getters or to formmatted array. This array is made of key/value pairs. Keys correspond to equivalent names of the helper getters. Values correspond to values the helper should have provided by calling corresponding getter.</p>
<p>For example, let's consider an instance of <em><a class="el" href="classAfsMetaHelper.html" title="AFS reply meta data. ">AfsMetaHelper</a>:</em> </p>
<ul>
<li>Meta data can be retrieve directly by calling appropriate getters: <div class="fragment"><div class="line">$meta = <span class="keyword">new</span> <a class="code" href="classAfsMetaHelper.html">AfsMetaHelper</a>($appropriate_initialization_value);</div>
<div class="line">$feed = $meta-&gt;get_feed();</div>
<div class="line">$total_replies = $meta-&gt;get_total_replies();</div>
<div class="line">$duration = $meta-&gt;get_duration();</div>
<div class="line">$producer = $meta-&gt;get_producer();</div>
</div><!-- fragment --> Or, by using shortcut feature described previously (<a class="el" href="afs_search_reply.html#asr_helper_getters">Getters</a>): <div class="fragment"><div class="line">$meta = <span class="keyword">new</span> <a class="code" href="classAfsMetaHelper.html">AfsMetaHelper</a>($appropriate_initialization_value);</div>
<div class="line">$feed = $meta-&gt;feed;</div>
<div class="line">$total_replies = $meta-&gt;total_replies;</div>
<div class="line">$duration = $meta-&gt;duration;</div>
<div class="line">$producer = $meta-&gt;producer;</div>
</div><!-- fragment --></li>
<li>Meta data can also be retrieved directly as an array of key/value pairs: <div class="fragment"><div class="line">$meta = <span class="keyword">new</span> <a class="code" href="classAfsMetaHelper.html">AfsMetaHelper</a>($appropriate_initialization_value);</div>
<div class="line">$data = $meta-&gt;format();</div>
</div><!-- fragment --> Example of produced array: <pre class="fragment">array(4) {
   ["feed"]=&gt; string(4) "Test"
   ["total_replies"]=&gt; int(666)
   ["duration"]=&gt; int(42)
   ["producer"]=&gt; string(6) "SEARCH"
}</pre></li>
</ul>
<p>Array format is the <em>default</em> format generated when initializing instance of <em><a class="el" href="classAfsResponseHelper.html" title="Main helper for AFS search reply. ">AfsResponseHelper</a></em>. This format greatly simplifies usage of PHP template engine such as Twig (see <a class="el" href="full_example_8php-example.html">full_example.php</a>).</p>
<p>Main drawback of this format is that it does not allow to access all data which are available by using helper format. This is mainly due to client data which are freely formatted and cannot be translated in key-value pairs.</p>
<h1><a class="anchor" id="asr_specific_helpers"></a>
Specific helpers</h1>
<p>Here some specific helpers are presented. They are not instanciated directly or indirectly by <em><a class="el" href="classAfsResponseHelper.html" title="Main helper for AFS search reply. ">AfsResponseHelper</a></em> but they can be really usefull.</p>
<h2><a class="anchor" id="asr_clientdata_helpers"></a>
Client data helpers</h2>
<p>Client data are really specific to each customer. So there is no generic way to integrate them in standard flow of treatments. To help you managing your own data, two kinds of client data helpers are available:</p>
<ul>
<li><em><a class="el" href="classAfsXmlClientDataHelper.html" title="XML client data helper. ">AfsXmlClientDataHelper</a>:</em> for XML data,</li>
<li><em><a class="el" href="classAfsJsonClientDataHelper.html" title="Helper for client data in JSON format. ">AfsJsonClientDataHelper</a>:</em> for JSON data.</li>
</ul>
<p>Instances of these classes are generally not created directly. A <em><a class="el" href="classAfsClientDataManager.html" title="Manage client data. ">AfsClientDataManager</a></em> is provided to generate appropriate client data helpers. Like for <em><a class="el" href="classAfsReplyHelper.html" title="Helper to manager title, abstract and uri of one reply. ">AfsReplyHelper</a></em>, it is initialized with a reply which should contain at least one client data. Then client data can be retrieved by <code>id</code> which has been provided on indexation side. If no <code>id</code> as been provided, it is defaultly set to <code>main</code>.</p>
<p>XML client data can be retrieved by <code>XPath</code>. There is no limitation except that XPath are limited to version 1.0.</p>
<p>JSON client data can be retrieved by <code>array key</code>. Only the first array level is considered. More details are vailable there: <em>AfsJsonClientDataHelper::get_text</em>.</p>
<p>Main common feature of these helpers is that they both manage highlight in client data. Default callbacks are used for highlighted text but specific ones can be defined.</p>
<h1><a class="anchor" id="asr_end"></a>
Next step</h1>
<h2><a class="anchor" id="asr_end_full_template"></a>
Full detailled example with template</h2>
<p>You are going to find in following link detailled example using PHP template engine. This example explains how to use this API and configure it in order to set up a fully functional integration. But you are advised to consider looking forward and see a more lightweight example in next section.</p>
<p>Detailled example with PHP template engine: <a class="el" href="detailled_integration_example_with_template.html">Detailled integration example with PHP template engine</a></p>
<h2><a class="anchor" id="asr_end_lightweight_template"></a>
Lightweight example with template</h2>
<p>If you compare this example with previous one you will nocite that the number of required configuration lines has been greatly reduced. However, same functionnalities are available and there is no difference in produced HTML pages.</p>
<p>Detailled lightweight example with PHP template engine: <a class="el" href="lightweight_integration_example_with_template.html">Lightweight integration example with PHP template engine</a></p>
<h2><a class="anchor" id="asr_end_full"></a>
Full detailled example without template</h2>
<p>Alternate example without template engine is also available: <a class="el" href="raw_integration_example.html">Integration example without PHP template engine</a> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Mar 17 2014 15:54:54 for Antidot PHP API by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
